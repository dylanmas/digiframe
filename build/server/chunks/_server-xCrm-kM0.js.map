{"version":3,"file":"_server-xCrm-kM0.js","sources":["../../../.svelte-kit/adapter-node/entries/endpoints/api/settings/_server.js"],"sourcesContent":["import fs from \"fs/promises\";\nimport { j as json } from \"../../../../chunks/index.js\";\nimport path from \"path\";\nimport { exec } from \"child_process\";\nconst filePath = path.join(process.cwd(), \"src/lib\", \"preferences.json\");\nasync function POST(request) {\n  const fileContents = await fs.readFile(filePath, \"utf-8\");\n  const data = JSON.parse(fileContents);\n  switch (request.url.searchParams.get(\"category\")) {\n    case \"frameorientation\":\n      data.settingsdata.frameorientation = request.url.searchParams.get(\"data\");\n      break;\n    case \"brightnessdisplay\":\n      data.settingsdata.brightnessdisplay = request.url.searchParams.get(\"data\");\n      break;\n    case \"factorymode\":\n      console.log(data.settingsdata.factorymode);\n      data.settingsdata.factorymode = request.url.searchParams.get(\"data\");\n      exec(\n        \"cp src/lib/default.json src/lib/preferences.json\",\n        (error, stdout, stderr) => {\n          if (error) {\n            console.log(error);\n            return;\n          }\n          if (stderr) {\n            console.log(stderr);\n            return;\n          }\n          console.log(stdout);\n        }\n      );\n      break;\n    case \"power\":\n      data.settingsdata.power = request.url.searchParams.get(\"data\");\n      if (data.settingsdata.power == \"poweroff\") {\n        exec(\"sleep 4 && systemctl poweroff\", (error, stdout, stderr) => {\n          if (error) {\n            console.log(error);\n            return;\n          }\n          if (stderr) {\n            console.log(stderr);\n            return;\n          }\n          console.log(stdout);\n        });\n      } else if (data.settingsdata.power == \"restart\") {\n        exec(\"sleep 4 && systemctl reboot\", (error, stdout, stderr) => {\n          if (error) {\n            console.log(error);\n            return;\n          }\n          if (stderr) {\n            console.log(stderr);\n            return;\n          }\n          console.log(stdout);\n        });\n      }\n      break;\n    case \"timezone\":\n      console.log(\n        `timedatectl set-timezone Etc/GMT${request.url.searchParams.get(\"subcategory\") == \"plus\" ? \"+\" : \"-\"}${request.url.searchParams.get(\"data\")}`\n      );\n      exec(\n        `timedatectl set-timezone Etc/GMT${request.url.searchParams.get(\"subcategory\") == \"plus\" ? \"+\" : \"-\"}${request.url.searchParams.get(\"data\")}`,\n        (error, stdout, stderr) => {\n          if (error) {\n            console.log(error);\n            return;\n          }\n          if (stderr) {\n            console.log(stderr);\n            return;\n          }\n          console.log(stdout);\n        }\n      );\n      console.log(request.url.searchParams.get(\"subcategory\"));\n      break;\n    case \"timedate\":\n      exec(\n        `timedatectl set-time Etc/GMT${request.url.searchParams.get(\"data\")}`,\n        (error, stdout, stderr) => {\n          if (error) {\n            console.log(error);\n            return;\n          }\n          if (stderr) {\n            console.log(stderr);\n            return;\n          }\n          console.log(stdout);\n        }\n      );\n      break;\n    case \"brightness\":\n      exec(\n        `ddcutil -d 1 setvcp 10 ${request.url.searchParams.get(\"data\")}`,\n        (error, stdout, stderr) => {\n          if (error) {\n            console.log(error);\n            return;\n          }\n          if (stderr) {\n            console.log(stderr);\n            return;\n          }\n          console.log(stdout);\n        }\n      );\n      break;\n    case \"display\":\n      exec(\n        `ddcutil -d 1 setvcp D6 ${request.url.searchParams.get(\"data\")}`,\n        (error, stdout, stderr) => {\n          if (error) {\n            console.log(error);\n            return;\n          }\n          if (stderr) {\n            console.log(stderr);\n            return;\n          }\n          console.log(stdout);\n        }\n      );\n      break;\n  }\n  Object.assign(data, request.body);\n  const tst1 = await fs.writeFile(filePath, JSON.stringify(data));\n  return json({ tst1 }, { status: 200 });\n}\nasync function GET() {\n  await fs.readFile(filePath, \"utf-8\");\n  var output = await fs.readFile(filePath, \"utf-8\");\n  exec(\n    `ip addr | grep 'state UP' -A2 | tail -n1 | awk '{print $2}' | cut -f1 -d'/'`,\n    async (error, stdout, stderr) => {\n      if (error) {\n        console.log(error);\n        return;\n      }\n      if (stderr) {\n        console.log(stderr);\n        return;\n      }\n      console.log(stdout);\n      output.settingsdata.ip = stdout.slice(0, -1);\n      await fs.writeFile(filePath, JSON.stringify(output));\n    }\n  );\n  output = JSON.parse(output);\n  return json({ output }, { status: 200 });\n}\nexport {\n  GET,\n  POST\n};\n"],"names":[],"mappings":"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"}